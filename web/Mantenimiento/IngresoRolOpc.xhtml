<ui:composition template="../Template/LayoutTrans.xhtml" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="content">
        <br></br>
        <br></br>
        <h:form id="principal">
            <p:growl id="mensaje" sticky="false" showDetail="true"/>
            <div class="container" id="page">
                <div class="span8" id="cont-hogar">
                    <div class="home-icon">
                        <img src="../resources/imagenes/RA_educacion_icon.png" width="54px" height="54px"></img>
                    </div>
                    <div class="hogar-title">
                        <h2>Ingreso Rol - Opción</h2>
                    </div>
                </div>
                <div class="clear"></div>

                <div class="breadcrumbs"></div>
                 #{menuController.init()}
                    <p:growl id="messages"/>
                    <p:menubar autoDisplay="false" model="#{menuController.menubar}" style="background: transparent; border: none">
                    </p:menubar>
                <div id="content" >

                    <p:accordionPanel id="acp" multiple="true">
                        <p:tab title="Ingreso Rol">
                            <h:panelGrid columns="4" style="width: 700px" id="panelIngresoRol">
                                <h:column>
                                    <h:outputText value="Nombre del rol" /><h:outputText value="*" style="color:red;"/>
                                </h:column>
                                <p:inputText value="#{rolController.rol.rolnombre}" onchange="this.value = mayuscula(this.value)" style="width: 200px" maxlength="100"/>
                                <h:outputText value="Estado" />
                                <p:selectOneMenu value="#{rolController.rol.rolestado}" filter="true" filterMatchMode="startsWith" style="width: 209px">
                                    <f:selectItem itemLabel="ACTIVO" itemValue="ACT" />
                                    <f:selectItem itemLabel="INACTIVO" itemValue="INA" />
                                </p:selectOneMenu>
                            </h:panelGrid>
                            <br></br>
                            <div style="text-align: left">
                                <p:commandButton value="Grabar" actionListener="#{rolController.grabar()}"  update=":principal:principal:mensaje,:principal:principal:acp:panConsulta"/>
                            </div>
                        </p:tab>
                        <p:tab title="Sección Consulta">
                            <h:panelGrid columns="4" style="width: 750px" id="panConsulta">
                                <h:outputText value="Rol" />
                                <p:selectOneMenu style="width: 200px" value="#{rolOpcionController.idconsulta}">
                                    <f:selectItem  itemLabel="Seleccione un rol" itemValue="" />
                                    <f:selectItems value="#{rolServices.rolesActivos}" var="rol" itemLabel="#{rol.rolnombre}" itemValue="#{rol.rolid}" />
                                </p:selectOneMenu>
                                <p:commandButton value="Buscar" actionListener="#{rolOpcionController.consulta()}" update="datosConsulta"/>
                            </h:panelGrid>
                            <br></br>
                            <p:dataTable id="datosConsulta" 
                                         emptyMessage="No existen datos para la consulta" 
                                         value="#{rolOpcionController.listaPosRolOpcion}" 
                                         var="rus" 
                                         rows="5"
                                         paginator="true"
                                         paginatorPosition="top"
                                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         rowsPerPageTemplate="5,10,15">
                                <p:column headerText="Rol" style="width: 10px;">
                                    <h:outputText value="#{rus.roprolid.rolnombre}" />
                                </p:column>
                                <p:column headerText="Opcion" style="width: 10px">
                                    <h:outputText value="#{rus.ropopcid.opcnombre}" />
                                </p:column>
                                <p:column headerText="Estado" style="width: 10px">
                                    <h:outputText value="#{rus.ropestado=='ACT' ? 'ACTIVO': 'INACTIVO'}" />
                                </p:column>
                                <p:column headerText="Modificar" style="width: 10px; text-align: center">
                                    <p:commandButton icon="ui-icon-document" actionListener="#{rolOpcionController.modificar(rus)}" update=":principal:principal:panIngreso" oncomplete="PF('dlgIngreso').show();"/>
                                </p:column>
                                <p:column headerText="Eliminar" style="width: 10px; text-align: center">
                                    <p:commandButton icon="ui-icon-trash" update=":principal:principal:mensaje, datosConsulta" actionListener="#{rolOpcionController.elimina(rus)}"/>
                                </p:column>
                            </p:dataTable>
                            <br></br>
                            <div style="text-align: left">
                                <p:commandButton value="Nuevo" actionListener="#{rolOpcionController.nuevo}" oncomplete="PF('dlgIngreso').show();" update=":principal:principal:panIngreso" />
                            </div>

                            <br></br>
                        </p:tab>
                    </p:accordionPanel>



                    <p:dialog widgetVar="dlgIngreso" width="800px" showEffect="fade" hideEffect="fade" closable="false" modal="true" resizable="false">
                        <h:panelGrid columns="4" style="width: 750px" id="panIngreso">
                            <h:outputText value="Rol" />
                            <p:selectOneMenu style="width: 200px" value="#{rolOpcionController.posRolOpcion.roprolid.rolid}">
                                <f:selectItems value="#{rolServices.rolesActivos}" var="rol" itemLabel="#{rol.rolnombre}" itemValue="#{rol.rolid}" />
                            </p:selectOneMenu>
                            <h:outputText value="Estado"  />
                            <p:selectOneMenu filter="true" filterMatchMode="startsWith" style="width: 209px" value="#{rolOpcionController.posRolOpcion.ropestado}">
                                <f:selectItem itemLabel="ACTIVO" itemValue="ACT" />
                                <f:selectItem itemLabel="INACTIVO" itemValue="INA" />
                            </p:selectOneMenu>
                            <h:outputText value="Menú" />
                            <p:selectOneMenu value="#{rolOpcionController.opcionPadre.opcid}" filter="true" filterMatchMode="startsWith" style="width: 209px">
                                <f:selectItem itemLabel="SELECCIONE UN MENÚ" itemValue="0" />
                                <f:selectItems value="#{opcionServices.opcionesPadre}" var="menu" itemLabel="#{menu.opcnombre}" itemValue="#{menu.opcid}" />
                                <p:ajax listener="#{rolOpcionController.selectionPadre()}" update="opcionHijo" />
                            </p:selectOneMenu>
                            <h:column>
                                <h:outputText value="Opción" /><h:outputText value="*" style="color:red;"/>
                            </h:column>
                            <p:selectOneMenu id="opcionHijo" filter="true" filterMatchMode="startsWith" style="width: 209px" value="#{rolOpcionController.posRolOpcion.ropopcid.opcid}">
                                <f:selectItem itemLabel="SELECCIONE UNA OPCIÓN" itemValue="0" />
                                <f:selectItems value="#{rolOpcionController.posOpciones}" var="opcion" itemLabel="#{opcion.opcnombre}" itemValue="#{opcion.opcid}" />
                            </p:selectOneMenu>
                        </h:panelGrid>
                        <div style="text-align: left">
                            <p:commandButton value="Grabar" actionListener="#{rolOpcionController.grabar()}" update=":principal:principal:mensaje,:principal:principal:acp:datosConsulta"/>
                            <p:commandButton value="Regresar" oncomplete="PF('dlgIngreso').hide();"/>
                        </div>
                    </p:dialog>   

                </div>
            </div>
        </h:form>
    </ui:define>
</ui:composition>

